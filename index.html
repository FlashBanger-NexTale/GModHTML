<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Loading...</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Bebas+Neue&family=Rajdhani:wght@300;400;600;700&display=swap');

  :root {
    --blue:    #4a7fa5;
    --blue-dim:#2a4f6a;
    --grey:    #8a9aaa;
    --grey-lt: #b8c4cc;
    --white:   #dce4e8;
    --dark:    #07090b;
    --panel:   rgba(8,12,16,0.88);
    --border:  rgba(100,140,170,0.18);
    --accent:  #5b9ec9;
  }

  * { margin:0; padding:0; box-sizing:border-box; }

  html, body {
    width:100%; height:100%;
    background: var(--dark);
    color: var(--white);
    font-family: 'Rajdhani', sans-serif;
    overflow: hidden;
    user-select: none;
  }

  .bg-slide {
    position: fixed; inset: 0; z-index: 0;
    background-size: cover;
    background-position: center;
    opacity: 0;
    transition: opacity 1.6s ease;
    filter: brightness(0.32) saturate(0.55) hue-rotate(10deg);
  }
  .bg-slide.active { opacity: 1; }

  #bg-overlay {
    position: fixed; inset: 0; z-index: 1;
    background:
      radial-gradient(ellipse at 50% 80%, rgba(30,60,90,0.35) 0%, transparent 60%),
      linear-gradient(to top,  rgba(0,0,0,0.92) 0%,  transparent 50%),
      linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, transparent 35%);
    pointer-events: none;
  }

  #scanlines {
    position: fixed; inset: 0; z-index: 2;
    background: repeating-linear-gradient(
      0deg, transparent, transparent 2px,
      rgba(0,0,0,0.06) 2px, rgba(0,0,0,0.06) 4px
    );
    pointer-events: none;
    animation: flicker 10s infinite;
  }
  @keyframes flicker {
    0%,100%{opacity:1} 91%{opacity:1} 92%{opacity:.82} 93%{opacity:1} 97%{opacity:.9} 98%{opacity:1}
  }

  #topbar {
    position: fixed; top:0; left:0; right:0;
    height: 48px;
    background: rgba(5,8,12,0.93);
    border-bottom: 1px solid var(--border);
    display: flex; align-items: center;
    padding: 0 20px; gap: 14px;
    z-index: 20;
  }
  #topbar-logo {
    width: 28px; height: 28px; flex-shrink: 0;
    object-fit: contain; opacity: 0.85;
  }
  #server-name-top {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 18px; letter-spacing: 2.5px;
    color: var(--white); flex: 1;
  }
  .top-badge {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px; letter-spacing: 1px;
    color: var(--grey); padding: 2px 0;
  }
  #gamemode-badge {
    color: var(--accent);
    border: 1px solid var(--blue-dim);
    padding: 2px 8px;
  }
  #music-btn {
    background: none;
    border: 1px solid var(--border);
    color: var(--grey);
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px; letter-spacing: 1px;
    padding: 3px 10px; cursor: pointer;
    transition: all 0.2s;
  }
  #music-btn:hover { border-color: var(--accent); color: var(--accent); }

  /* THE FIX: proper centering in GMod's embedded browser */
  #center {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10;
    gap: 10px;
  }
  #center-inner {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
  }

  #main-logo {
    width: 120px; height: 120px;
    object-fit: contain;
    opacity: 0;
    animation: fadeUp 1.1s ease 0.2s forwards;
    filter: drop-shadow(0 0 24px rgba(74,127,165,0.45))
            drop-shadow(0 0 8px rgba(74,127,165,0.3));
  }
  #main-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(40px, 6.5vw, 70px);
    letter-spacing: 10px;
    color: var(--white);
    opacity: 0;
    animation: fadeUp 1.1s ease 0.4s forwards;
    text-shadow: 0 0 50px rgba(74,127,165,0.3);
    margin-top: 6px;
  }
  #main-subtitle {
    font-family: 'Rajdhani', sans-serif;
    font-weight: 300; font-size: 12px;
    letter-spacing: 5px; color: var(--grey);
    text-transform: uppercase;
    opacity: 0;
    animation: fadeUp 1.1s ease 0.6s forwards;
    margin-top: 4px;
  }
  #player-count {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px; color: var(--blue);
    letter-spacing: 2px;
    opacity: 0;
    animation: fadeUp 1.1s ease 0.8s forwards;
    margin-top: 10px;
  }
  .h-rule {
    width: 180px; height: 1px;
    background: linear-gradient(90deg, transparent, var(--border), transparent);
    opacity: 0;
    animation: fadeUp 1.1s ease 0.5s forwards;
    margin-top: 8px; margin-bottom: 4px;
  }

  @keyframes fadeUp {
    from { opacity:0; transform:translateY(14px); }
    to   { opacity:1; transform:translateY(0); }
  }

  /* BOTTOM BAR */
  #bottombar {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 75%;
    background: rgba(5,8,12,0.93);
    border-top: 1px solid var(--border);
    padding: 6px 20px 8px;
    z-index: 20;
  }
  #progress-label {
    display: flex; justify-content: space-between; align-items: flex-end;
    margin-bottom: 7px;
  }
  #status-text {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px; color: var(--grey); letter-spacing: 1px;
  }
  #progress-pct {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px; color: var(--accent); letter-spacing: 1px;
  }
  #progress-track {
    width: 100%; height: 18px;
    background: rgba(255,255,255,0.06);
    position: relative; overflow: hidden;
  }
  #progress-fill {
    height: 100%; width: 0%;
    background: linear-gradient(90deg, var(--blue-dim), var(--accent));
    transition: width 0.45s ease;
    box-shadow: 0 0 10px var(--accent);
    position: relative;
  }
  #progress-fill::after {
    content:''; position:absolute; right:0; top:0; bottom:0; width:30px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5));
    animation: shimmer 1.4s ease infinite;
  }
  @keyframes shimmer { 0%{opacity:0} 50%{opacity:1} 100%{opacity:0} }
  #file-info {
    font-family: 'Share Tech Mono', monospace;
    font-size: 9px; color: rgba(138,154,170,0.35);
    letter-spacing: 1px; margin-top: 6px;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }

  .bracket { position: fixed; width: 16px; height: 16px; z-index: 15; opacity: 0.25; }
  .bracket-tl { top:55px;  left:10px;  border-top:1px solid var(--grey-lt); border-left:1px solid var(--grey-lt); }
  .bracket-tr { top:55px;  right:10px; border-top:1px solid var(--grey-lt); border-right:1px solid var(--grey-lt); }
  .bracket-bl { bottom:78px; left:10px;  border-bottom:1px solid var(--grey-lt); border-left:1px solid var(--grey-lt); }
  .bracket-br { bottom:78px; right:10px; border-bottom:1px solid var(--grey-lt); border-right:1px solid var(--grey-lt); }

  audio { display:none; }
</style>
</head>
<body>

<div class="bg-slide active" id="bg0" style="background-image:url('https://i.ibb.co/Fvn9V8J/2026-02-16-114621.png')"></div>
<div class="bg-slide"        id="bg1" style="background-image:url('https://i.ibb.co/zh4B6Nr8/2026-02-16-115025.png')"></div>
<div class="bg-slide"        id="bg2" style="background-image:url('https://i.ibb.co/60F4VB4Q/2026-02-16-115405.png')"></div>
<div class="bg-slide"        id="bg3" style="background-image:url('https://i.ibb.co/C5Hmd31z/2026-02-16-115438.png')"></div>

<div id="bg-overlay"></div>
<div id="scanlines"></div>

<div class="bracket bracket-tl"></div>
<div class="bracket bracket-tr"></div>
<div class="bracket bracket-bl"></div>
<div class="bracket bracket-br"></div>

<audio id="audio" loop>
  <source src="" type="audio/mpeg">
</audio>

<div id="topbar">
  <img id="topbar-logo" src="https://i.ibb.co/4n16yy21/2026-02-17-170243734.png" alt="logo">
  <div id="server-name-top">LOADING...</div>
  <div class="top-badge" id="map-badge">MAP: —</div>
  <div class="top-badge" id="gamemode-badge">—</div>
  <button id="music-btn" onclick="toggleMusic()">♪ MUSIC: ON</button>
</div>

<div id="center">
  <div id="center-inner">
    <img id="main-logo" src="https://i.ibb.co/4n16yy21/2026-02-17-170243734.png" alt="SCP Logo">
    <div id="main-title">SCP BREACH</div>
    <div class="h-rule"></div>
    <div id="main-subtitle">Special Containment Procedures Foundation</div>
    <div id="player-count">CONNECTING...</div>
  </div>
</div>

<div id="bottombar">
  <div id="progress-label">
    <span id="status-text">INITIALIZING SECURE CONNECTION...</span>
    <span id="progress-pct">0%</span>
  </div>
  <div id="progress-track">
    <div id="progress-fill"></div>
  </div>
  <div id="file-info">—</div>
</div>

<script>
  var slides = document.querySelectorAll('.bg-slide');
  var bgIndex = 0;
  setInterval(function() {
    slides[bgIndex].classList.remove('active');
    bgIndex = (bgIndex + 1) % slides.length;
    slides[bgIndex].classList.add('active');
  }, 8000);
</script>

<script>
  var audio = document.getElementById('audio');
  var musicOn = true;

  function tryPlay() {
    var src = audio.querySelector('source').getAttribute('src');
    if (!src) return;
    audio.volume = 0.35;
    audio.play().catch(function() {
      document.addEventListener('click', function once() {
        audio.play();
        document.removeEventListener('click', once);
      });
    });
  }

  function toggleMusic() {
    var btn = document.getElementById('music-btn');
    musicOn = !musicOn;
    if (musicOn) { audio.play(); btn.textContent = '♪ MUSIC: ON'; }
    else         { audio.pause(); btn.textContent = '♪ MUSIC: OFF'; }
  }

  tryPlay();
</script>

<script>
  var _totalFiles = 0;
  var _neededFiles = 0;

  function updateProgress() {
    var pct = _totalFiles > 0
      ? Math.round(((_totalFiles - _neededFiles) / _totalFiles) * 100)
      : 0;
    document.getElementById('progress-fill').style.width = pct + '%';
    document.getElementById('progress-pct').textContent  = pct + '%';
  }

  window.GameDetails = function(serverName, serverURL, mapName, maxPlayers, steamID, gamemode, volume, language) {
    document.getElementById('server-name-top').textContent = serverName || 'SCP BREACH';
    document.getElementById('map-badge').textContent       = 'MAP: ' + (mapName  ? mapName.toUpperCase()  : '—');
    document.getElementById('gamemode-badge').textContent  = gamemode ? gamemode.toUpperCase()             : '—';

    // GameDetails doesn't provide current player count — fetch it via server query if needed
    // For now shows: —/32
    document.getElementById('player-count').textContent = '— / ' + (maxPlayers || '—');

    // Fetch live player count from Steam server info
    // Replace YOUR_SERVER_IP and YOUR_SERVER_PORT with your actual server details
    var serverIP   = 'YOUR_SERVER_IP';
    var serverPort = 'YOUR_SERVER_PORT';
    fetch('https://api.steampowered.com/ISteamApps/GetServersAtAddress/v0001/?addr=' + serverIP + ':' + serverPort + '&format=json')
      .then(function(r) { return r.json(); })
      .then(function(data) {
        if (data.response && data.response.servers && data.response.servers[0]) {
          var s = data.response.servers[0];
          document.getElementById('player-count').textContent = (s.players || '—') + ' / ' + (maxPlayers || '—');
        }
      })
      .catch(function() { /* silently fail, keep showing —/max */ });

    if (typeof volume === 'number') audio.volume = Math.min(1, volume * 0.6);
    tryPlay();
  };

  window.SetFilesTotal = function(total) {
    _totalFiles  = total;
    _neededFiles = total;
    updateProgress();
  };

  window.SetFilesNeeded = function(needed) {
    _neededFiles = needed;
    updateProgress();
  };

  window.DownloadingFile = function(fileName) {
    document.getElementById('file-info').textContent = fileName || '—';
  };

  window.SetStatusChanged = function(status) {
    document.getElementById('status-text').textContent = status ? status.toUpperCase() : 'INITIALIZING...';
    if (status && (status.toLowerCase().includes('done') || status.toLowerCase().includes('ready') || status.toLowerCase().includes('complete'))) {
      document.getElementById('progress-fill').style.width = '100%';
      document.getElementById('progress-pct').textContent  = '100%';
    }
  };
</script>

</body>
</html>
