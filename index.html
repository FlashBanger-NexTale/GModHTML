<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Loading...</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Bebas+Neue&family=Rajdhani:wght@300;400;600;700&display=swap');

  :root {
    --red: #c0392b;
    --red-dim: #7a1f1f;
    --amber: #e67e22;
    --white: #e8e4dc;
    --grey: #a0998a;
    --dark: #080808;
    --panel: rgba(10,10,10,0.82);
    --border: rgba(200,190,170,0.12);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  html, body {
    width: 100%; height: 100%;
    background: var(--dark);
    color: var(--white);
    font-family: 'Rajdhani', sans-serif;
    overflow: hidden;
    user-select: none;
  }

  /* ── BACKGROUND ── */
  #bg {
    position: fixed; inset: 0; z-index: 0;
    background-size: cover;
    background-position: center;
    transition: opacity 1.8s ease;
    filter: brightness(0.28) saturate(0.6);
  }

  #bg-overlay {
    position: fixed; inset: 0; z-index: 1;
    background:
      radial-gradient(ellipse at 50% 100%, rgba(120,20,10,0.25) 0%, transparent 65%),
      linear-gradient(to top, rgba(0,0,0,0.85) 0%, transparent 60%),
      linear-gradient(to bottom, rgba(0,0,0,0.6) 0%, transparent 40%);
    pointer-events: none;
  }

  /* scanlines */
  #scanlines {
    position: fixed; inset: 0; z-index: 2;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0,0,0,0.08) 2px,
      rgba(0,0,0,0.08) 4px
    );
    pointer-events: none;
    animation: flicker 8s infinite;
  }
  @keyframes flicker {
    0%,100% { opacity: 1; }
    92% { opacity: 1; }
    93% { opacity: 0.85; }
    94% { opacity: 1; }
    97% { opacity: 0.9; }
    98% { opacity: 1; }
  }

  /* ── LAYOUT ── */
  #ui {
    position: fixed; inset: 0; z-index: 10;
    display: grid;
    grid-template-rows: 1fr auto;
    padding: 0;
  }

  /* ── TOP BAR ── */
  #topbar {
    position: fixed; top: 0; left: 0; right: 0;
    height: 52px;
    background: rgba(6,6,6,0.9);
    border-bottom: 1px solid var(--border);
    display: flex; align-items: center;
    padding: 0 24px;
    gap: 16px;
    z-index: 20;
  }

  #scp-logo {
    width: 32px; height: 32px; flex-shrink: 0;
  }

  #server-name-top {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 20px;
    letter-spacing: 2px;
    color: var(--white);
    flex: 1;
  }

  #gamemode-badge {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--red);
    border: 1px solid var(--red-dim);
    padding: 3px 8px;
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  #map-badge {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--grey);
    letter-spacing: 1px;
  }

  /* ── MUSIC CONTROL ── */
  #music-btn {
    background: none;
    border: 1px solid var(--border);
    color: var(--grey);
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    padding: 4px 10px;
    cursor: pointer;
    letter-spacing: 1px;
    transition: all 0.2s;
  }
  #music-btn:hover { border-color: var(--white); color: var(--white); }

  /* ── CENTER LOGO ── */
  #center {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    gap: 12px;
    margin-top: 52px;
    margin-bottom: 110px;
  }

  #main-logo {
    width: 110px; height: 110px;
    opacity: 0;
    animation: fadeUp 1.2s ease 0.3s forwards;
    filter: drop-shadow(0 0 20px rgba(192,57,43,0.4));
  }

  #main-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(42px, 7vw, 72px);
    letter-spacing: 8px;
    color: var(--white);
    opacity: 0;
    animation: fadeUp 1.2s ease 0.5s forwards;
    text-shadow: 0 0 40px rgba(192,57,43,0.3);
  }

  #main-subtitle {
    font-family: 'Rajdhani', sans-serif;
    font-size: 13px;
    font-weight: 300;
    letter-spacing: 5px;
    color: var(--grey);
    text-transform: uppercase;
    opacity: 0;
    animation: fadeUp 1.2s ease 0.7s forwards;
  }

  #player-count {
    font-family: 'Share Tech Mono', monospace;
    font-size: 11px;
    color: var(--red);
    letter-spacing: 2px;
    opacity: 0;
    animation: fadeUp 1.2s ease 0.9s forwards;
    margin-top: 4px;
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  /* ── BOTTOM BAR ── */
  #bottombar {
    position: fixed; bottom: 0; left: 0; right: 0;
    background: rgba(6,6,6,0.92);
    border-top: 1px solid var(--border);
    padding: 14px 28px 16px;
    z-index: 20;
  }

  #progress-label {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    margin-bottom: 8px;
  }

  #status-text {
    font-family: 'Share Tech Mono', monospace;
    font-size: 11px;
    color: var(--grey);
    letter-spacing: 1px;
  }

  #progress-pct {
    font-family: 'Share Tech Mono', monospace;
    font-size: 11px;
    color: var(--red);
    letter-spacing: 1px;
  }

  #progress-track {
    width: 100%;
    height: 3px;
    background: rgba(255,255,255,0.07);
    position: relative;
    overflow: hidden;
  }

  #progress-fill {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, var(--red-dim), var(--red));
    transition: width 0.4s ease;
    box-shadow: 0 0 8px var(--red);
    position: relative;
  }

  #progress-fill::after {
    content: '';
    position: absolute;
    right: 0; top: 0; bottom: 0;
    width: 40px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4));
    animation: shimmer 1.2s ease infinite;
  }
  @keyframes shimmer {
    0% { opacity: 0; } 50% { opacity: 1; } 100% { opacity: 0; }
  }

  #file-info {
    font-family: 'Share Tech Mono', monospace;
    font-size: 9px;
    color: rgba(160,153,138,0.4);
    letter-spacing: 1px;
    margin-top: 7px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 60%;
  }

  /* corner brackets */
  .bracket-tl, .bracket-tr, .bracket-bl, .bracket-br {
    position: fixed; width: 20px; height: 20px; z-index: 15;
    opacity: 0.3;
  }
  .bracket-tl { top: 60px; left: 12px; border-top: 1px solid var(--white); border-left: 1px solid var(--white); }
  .bracket-tr { top: 60px; right: 12px; border-top: 1px solid var(--white); border-right: 1px solid var(--white); }
  .bracket-bl { bottom: 100px; left: 12px; border-bottom: 1px solid var(--white); border-left: 1px solid var(--white); }
  .bracket-br { bottom: 100px; right: 12px; border-bottom: 1px solid var(--white); border-right: 1px solid var(--white); }

  /* ── HIDDEN AUDIO ── */
  #audio { display: none; }
</style>
</head>
<body>

<!-- Background image -->
<div id="bg"></div>
<div id="bg-overlay"></div>
<div id="scanlines"></div>

<!-- Corner brackets -->
<div class="bracket-tl"></div>
<div class="bracket-tr"></div>
<div class="bracket-bl"></div>
<div class="bracket-br"></div>

<!-- Audio -->
<audio id="audio" loop>
  <!--
    PUT YOUR MUSIC URL HERE.
    Example: <source src="https://yourserver.com/music/ambient.mp3" type="audio/mpeg">
    Multiple sources for fallback:
    <source src="music.ogg" type="audio/ogg">
    <source src="music.mp3" type="audio/mpeg">
  -->
  <source src="" type="audio/mpeg">
</audio>

<!-- UI -->
<div id="ui">

  <!-- Top bar -->
  <div id="topbar">
    <!-- SCP Logo SVG (the classic arrow symbol) -->
    <svg id="scp-logo" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="50" cy="50" r="46" stroke="#c0392b" stroke-width="2" fill="none"/>
      <circle cx="50" cy="50" r="32" stroke="#c0392b" stroke-width="1.5" fill="none"/>
      <circle cx="50" cy="50" r="6" fill="#c0392b"/>
      <line x1="50" y1="4" x2="50" y2="18" stroke="#c0392b" stroke-width="2"/>
      <line x1="83" y1="66" x2="70" y2="59" stroke="#c0392b" stroke-width="2"/>
      <line x1="17" y1="66" x2="30" y2="59" stroke="#c0392b" stroke-width="2"/>
      <!-- Arrow pointing right on middle ring -->
      <path d="M82 50 L96 50 M90 44 L96 50 L90 56" stroke="#c0392b" stroke-width="1.5" fill="none"/>
    </svg>

    <div id="server-name-top">LOADING...</div>
    <div id="map-badge">MAP: —</div>
    <div id="gamemode-badge">—</div>
    <button id="music-btn" onclick="toggleMusic()">♪ MUSIC: ON</button>
  </div>

  <!-- Center -->
  <div id="center">
    <!-- SCP Foundation big logo -->
    <svg id="main-logo" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="100" cy="100" r="94" stroke="#c0392b" stroke-width="3" fill="none"/>
      <circle cx="100" cy="100" r="66" stroke="#c0392b" stroke-width="2" fill="none"/>
      <circle cx="100" cy="100" r="12" fill="#c0392b"/>
      <!-- Three arrows -->
      <line x1="100" y1="6" x2="100" y2="34" stroke="#c0392b" stroke-width="3"/>
      <path d="M100 6 L93 18 M100 6 L107 18" stroke="#c0392b" stroke-width="2" fill="none"/>
      <line x1="168" y1="131" x2="143" y2="117" stroke="#c0392b" stroke-width="3"/>
      <path d="M168 131 L155 126 M168 131 L161 119" stroke="#c0392b" stroke-width="2" fill="none"/>
      <line x1="32" y1="131" x2="57" y2="117" stroke="#c0392b" stroke-width="3"/>
      <path d="M32 131 L45 126 M32 131 L39 119" stroke="#c0392b" stroke-width="2" fill="none"/>
    </svg>

    <div id="main-title">SCP BREACH</div>
    <div id="main-subtitle">Special Containment Procedures Foundation</div>
    <div id="player-count">CONNECTING...</div>
  </div>

  <!-- Bottom bar -->
  <div id="bottombar">
    <div id="progress-label">
      <span id="status-text">INITIALIZING SECURE CONNECTION...</span>
      <span id="progress-pct">0%</span>
    </div>
    <div id="progress-track">
      <div id="progress-fill"></div>
    </div>
    <div id="file-info">—</div>
  </div>

</div>

<!-- Background slideshow images — edit these URLs -->
<script>
  var BG_IMAGES = [
    // Add your background image URLs here, e.g.:
    // "https://yourserver.com/img/bg1.jpg",
    // "https://yourserver.com/img/bg2.jpg",
    // Falls back to a dark solid if empty
    "https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?w=1920&q=60",
    "https://images.unsplash.com/photo-1518770660439-4636190af475?w=1920&q=60",
    "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=1920&q=60"
  ];

  var bgEl = document.getElementById('bg');
  var bgIndex = 0;

  function nextBackground() {
    if (BG_IMAGES.length === 0) return;
    bgEl.style.backgroundImage = 'url(' + BG_IMAGES[bgIndex] + ')';
    bgIndex = (bgIndex + 1) % BG_IMAGES.length;
  }

  nextBackground();
  setInterval(function() {
    bgEl.style.opacity = '0';
    setTimeout(function() {
      nextBackground();
      bgEl.style.opacity = '1';
    }, 900);
  }, 8000);
  bgEl.style.opacity = '1';
</script>

<!-- Music -->
<script>
  var audio = document.getElementById('audio');
  var musicOn = true;

  // Autoplay with user interaction fallback
  function tryPlay() {
    var src = audio.querySelector('source') ? audio.querySelector('source').src : '';
    if (!src) return; // no music configured
    audio.volume = 0.35;
    audio.play().catch(function() {
      // Autoplay blocked — play on first click
      document.addEventListener('click', function once() {
        audio.play();
        document.removeEventListener('click', once);
      });
    });
  }

  function toggleMusic() {
    var btn = document.getElementById('music-btn');
    if (musicOn) {
      audio.pause();
      btn.textContent = '♪ MUSIC: OFF';
    } else {
      audio.play();
      btn.textContent = '♪ MUSIC: ON';
    }
    musicOn = !musicOn;
  }

  // Respect the game's music volume setting
  window._gameVolume = 1;

  tryPlay();
</script>

<!-- GMod Loading Screen API -->
<script>
  var _totalFiles = 0;
  var _neededFiles = 0;
  var _currentFile = '';

  function updateProgress() {
    var pct = 0;
    if (_totalFiles > 0) {
      pct = Math.round(((_totalFiles - _neededFiles) / _totalFiles) * 100);
    }
    document.getElementById('progress-fill').style.width = pct + '%';
    document.getElementById('progress-pct').textContent = pct + '%';
  }

  // Called when loading starts — receives all server details
  window.GameDetails = function(serverName, serverURL, mapName, maxPlayers, steamID, gamemode, volume, language) {
    // Server name in top bar
    document.getElementById('server-name-top').textContent = serverName || 'SCP BREACH';

    // Update main title if server name contains something interesting
    // document.getElementById('main-title').textContent = serverName;

    // Map
    document.getElementById('map-badge').textContent = 'MAP: ' + (mapName ? mapName.toUpperCase() : '—');

    // Gamemode
    document.getElementById('gamemode-badge').textContent = gamemode ? gamemode.toUpperCase() : '—';

    // Players
    document.getElementById('player-count').textContent = 'MAX PLAYERS: ' + (maxPlayers || '—');

    // Music volume from game settings
    if (typeof volume === 'number' && audio) {
      audio.volume = Math.max(0, Math.min(1, volume * 0.6));
    }

    tryPlay();
  };

  window.SetFilesTotal = function(total) {
    _totalFiles = total;
    _neededFiles = total;
    updateProgress();
  };

  window.SetFilesNeeded = function(needed) {
    _neededFiles = needed;
    updateProgress();
  };

  window.DownloadingFile = function(fileName) {
    _currentFile = fileName;
    document.getElementById('file-info').textContent = fileName || '—';
  };

  window.SetStatusChanged = function(status) {
    document.getElementById('status-text').textContent = status
      ? status.toUpperCase()
      : 'INITIALIZING...';

    // When fully connected, push to 100%
    if (status && (status.toLowerCase().includes('done') || status.toLowerCase().includes('ready'))) {
      document.getElementById('progress-fill').style.width = '100%';
      document.getElementById('progress-pct').textContent = '100%';
    }
  };
</script>

</body>
</html>
